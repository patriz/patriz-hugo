box: debian
build:
  steps:
    - script:
        name: install required packages
        code: |
            apt-get update
            apt-get install git python-pip python3-pygments -y
    - script:
        name: install pygments
        code: pip install Pygments
    - script:
        name: initialize git submodules
        code: |
            echo "initialize git submodules"
            git submodule update --init --recursive
    - arjen/hugo-build:
        config: config.toml
        flags: "--buildDrafts=false"
        theme: redlounge
        version: "0.16"
  after-steps:
    - script:
        name: install required packages
        code: |
            apt-get install git curl -y
    - miaoxing/github-issue-notify:
        token: $GITHUB_ISSUE_TOKEN
        repo: ziwon/ziwon-hugo
deploy:
  steps:
    - script:
        name: install git
        code: |
            apt-get update
            apt-get install git -y
    - lukevivier/gh-pages@0.2.1:
        token: $GIT_TOKEN
        basedir: public
        repo: ziwon/ziwon.github.io
