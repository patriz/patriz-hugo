+++
date          = "2018-12-05T12:58:00+00:00"
draft         = true
title         = "[번역] 확장 가능한 포터블 도커 컨테이너 네트워크 디자인"
tags          = ["Networking", "Docker"]
categories    = ["DevOps"]
slug          = "designing-scalable-portable-docker-container-networks"
notoc         = true
socialsharing = true
nocomment     = false
+++


# 배우게 될 것

도커 컨테이너는 실행에 필요한 모든 것, 즉 코드, 런타임, 시스템 도구, 시스템 라이브러리 등 서버에 설치할 수 있는 모든 것을 포함하는 완전한 파일 시스템에 있는 소프트웨어 하나를 래핑한다. 이는 소프트웨어가 환경에 관계없이 항상 동일한 기능을 실행할 것을 보장한다. 기본적으로 컨테이너는 어플리케이션을 서로 격리하고, 애플리케이션을 위한 추가적인 보호 계층을 제공한다.

애플리케이션이 서로 간에 또는 호스트와 혹은 외부 네트워크와 통신해야 한다면 어떻게 하는가? 애플리케이션 이식성, 서비스 검색, 로드 밸런싱, 보안, 성능 및 확장성을 유지하면서 적절한 커넥티비티을 위해 네트워크를 설계하는 방법은 무엇인가? 이 문서는 이러한 네트워크 설계 문제와 사용 가능한 도구 및 일반적인 배포 패턴을 다룬다. 물리적 네트워크 설계를 지정하거나 권장하지는 않지만 애플리케이션과 물리적 네트워크의 제약조건을 고려하면서 도커 네트워크를 설계하는 방법에 대한 옵션을 제공한다.

## 사전 지식
계속하기 전에 도커 개념과 도커 스웜에 대해 잘 알고 있어야 한다.

- [도커 개념](https://docs.docker.com/engine/understanding-docker/)
- [도커 스웜 및 스웜 모드 개념](https://docs.docker.com/engine/swarm/key-concepts/#/services-and-tasks)

# 네트워킹 컨테이너 및 마이크로 서비스의 도전

마이크로서비스는 실전에서 애플리케이션의 스케일을 증가시켰는데, 이러한 애플리케이션들은 제공되는 커넥티비티 및 격리 방법들이 훨씬 더 중시된다. 도커 네트워킹 철학은 애플리케이션 중심이다. 네트워크 운영자에게 옵션과 유연성을 제공하는 것을 목표로 하는 것 뿐만 아니라 애플리케이션 개발자에게 적합한 수준의 추상화를 제공하는 것을 목표로 한다.

여느 디자인처럼, 네트워크 디자인은 균형을 맞추는 행위이다. 도커 엔터프라이즈 에디션과 도커 생태계는 네트워크 엔지니어들에게 그들의 애플리케이션과 환경에 대한 최상의 균형을 달성하기 위해 다양한 도구를 제공한다. 각 옵션은 서로 다른 장점과 트레이드오프를 제공한다. 이 가이드의 나머지 부분에서는 네트워크 엔지니어가 자신의 환경에 가장 적합한 것을 이해할 수 있도록 이러한 각각 선택에 대해 자세히 설명한다.

도커는 애플리케이션을 공급하는 새로운 방법을 개발했고, 그와 함께 컨테이너는 네트워킹 접근 방식의 일부 측면도 변화시켰다. 다음 주제는 컨테이너형 애플리케이션에 대한 일반적인 디자인 테마이다.

- **이식성**
	- 고유한 네트워크 특성을 활용하면서 다양한 네트워크 환경에서 최대한의 이식성을 어떻게 보장할 수 있는가?

- **서비스 검색**
	- 서비스가 확장 및 축소될 때 어디에 살고 있는지 어떻게 알 수 있는가?

- **로드 밸런싱**
	- 서비스 자체가 커지고 확장될 때 서비스 간에 부하를 어떻게 공유하는가?

- **보안**
	- 잘못된 컨테이너가 서로 액세스하지 못하도록 어떻게 구분하는가?
	- 애플리케이션 및 클러스터 제어 트래픽이 있는 컨테이너가 안전하다는 것을 어떻게 보장하는가?

- **성능**
	- 대기 시간을 최소화하고 대역폭을 최대화하는 동시에 고급 네트워크 서비스를 어떻게 제공하는가?

- **확장성**
	- 여러 호스트에 걸쳐 애플리케이션을 확장할 때 이러한 특성들이 저하되지 않도록 하려면 어떻게 하는가?


# 컨테이너 네트워킹 모델

도커 네트워킹 아키텍처는 CNM(Container Networking Model)이라고 하는 인터페이스 집합 위에 구축된다. CNM의 철학은 다양한 인프라 구조에서 애플리케이션 이식성을 제공하는 것이다. 이 모델은 애플리케이션 이식성을 달성하기 위해 균형을 맞추고 인프라의 특수 기능과 역량을 활용한다.

![](https://success.docker.com/api/images/.%2Frefarch%2Fnetworking%2Fimages%2Fcnm.png)

## CNM 구조

CNM에는 몇 가지 상위 레벨의 구조가 있다. 이들은 모두 OS 및 인프라에 구애받지 않으므로 인프라 스택에 관계없이 애플리케이션이 동일한 환경을 가질 수 있다.

- **샌드박스** - 샌드박스는 컨테이너 네트워크 스택의 구성을 포함한다. 여기에는 컨테이너 인터페이스, 라우팅 테이블 및 DNS 설정 관리가 포함된다. 샌드박스의 구현은 Linux 네트워크 네임스페이스, FreeBSD Jail 또는 기타 유사한 개념일 수 있다. 샌드박스는 여러 네트워크의 많은 엔드포인트를 포함할 수 있다.
- **엔드포인트** - 엔드포인트가 샌드박스를 네트워크에 연결한다. 엔드포인트의 구조는 네트워크에 대한 실제 연결을 애플리케이션에서 추상화할 수 있도록 존재한다. 이는 서비스가 네트워크에 어떻게 연결되어 있는지에 신경쓰지 않으며 여러 유형의 네트워크 드라이버를 사용할 수 있도록 이식성을 유지하는데 도움을 준다.
- **네트워크** — CNM은 OSI 모델 측면에서 네트워크를 지정하지 않는다. 네트워크의 구현은 Linux 브리지, VLAN 등이 될 수 있다. 네트워크는 이들 사이에 연결성이 있는 엔드포인트의 모음이다. 네트워크에 연결되지 않은 엔드포인트는 네트워크에 연결되어 있지 않다.

## CNM 드라이버 인터페이스
컨테이너 네트워킹 모델은 사용자, 커뮤니티 및 벤더가 네트워크에서 추가 기능, 가시성 또는 제어 기능을 활용할 수 있는 2개의 플러그형 및 개방형 인터페이스를 제공한다.

다음 네트워크 드라이버가 있다:

- **네트워크 드라이버** - 도커 네트워크 드라이버는 네트워크를 작동시키는 실제 구현을 제공한다. 다른 드라이버를 사용할 수 있고 다양한 유스케이스를 쉽게 지원할 수 있도록 상호 교환될 수 있는 플러그 스타일이다. 주어진 도커 엔진 또는 클러스터에서 여러 개의 네트워크 드라이버를 동시에 사용할 수 있지만, 각 도커 네트워크는 단일 네트워크 드라이버를 통해서만 인스턴스화된다. CNM 네트워크 드라이버는 크게 두 가지 유형이 있다.
	- **네이티브 네트워크 드라이버** - 네이티브 네트워크 드라이버는 도커 엔진의 기본 요소이며 도커에서 제공한다. 오버레이 네트워크나 로컬 브리지와 같은 다양한 기능을 지원하는 여러 드라이버가 있다.
	- **원격 네트워크 드라이버** - 원격 네트워크 드라이버는 커뮤니티와 다른 벤더가 생성한 네트워크 드라이버이다. 이러한 드라이버는 기존 소프트웨어 및 하드웨어와의 통합을 제공할 수 있다. 사용자는 또한 기존 네트워크 드라이버가 지원하지 않는 특정 기능을 원하는 경우 자신의 드라이버를 만들 수도 있다.
- **IPAM 드라이버** - 도커에는 네트워크 및 엔드포인트의 기본 서브넷 또는 IP 주소를 지정하지 않은 경우 이를 제공하는 네이티브 IP 주소 관리 드라이버가 있다. IP 어드레싱은 네트워크, 컨테이너 및 서비스 생성 명령을 통해 수동으로 할당할 수도 있다. 원격 IPAM 드라이버도 존재하며 기존 IPAM 도구와 통합된다.

![](https://success.docker.com/api/images/.%2Frefarch%2Fnetworking%2Fimages%2Fcnm-api.png)


## Docker Native Network Drivers

## Network Scope
## Docker Remote Network Drivers
## Docker Remote IPAM Drivers

# Linux Network Fundamentals
## The Linux Bridge
## Network Namespaces
## Virtual Ethernet Devices
## iptables

# Docker Network Control Plane

# Docker Host Network Driver

# Docker Bridge Network Driver

## Default Docker Bridge Network

## User-Defined Bridge Networks

## External Access for Standalone Containers

# Overlay Driver Network Architecture

## VXLAN Data Plane
## Overlay Driver Internal Architecture

# External Access for Docker Services

## Ingress Mode Service Publishing
## Host Mode Service Publishing
## Ingress Design
# MACVLAN
## VLAN Trunking with MACVLAN

# None (Isolated) Network Driver

# Physical Network Design Requirements

# Swarm Native Service Discovery

# Docker Native Load Balancing

## UCP Internal Load Balancing

## UCP External L4 Load Balancing (Docker Routing Mesh)

## UCP External L7 Load Balancing (HTTP Routing Mesh)

# Docker Network Security and Encryption

## Network Segmentation and Data Plane Security

## Control Plane Security
## Data Plane Network Encryption
## Management Plane Security & RBAC with UCP

# IP Address Management

# Network Troubleshooting

# Network Deployment Models

## Bridge Driver on a Single Host
## Multi-Host Bridge Driver with External Service Discovery
## Multi-Host with Overlay Driver
### Overlay Benefits and Use Cases

## Tutorial App: MACVLAN Bridge Mode

### MACVLAN Benefits and Use Cases

# Conclusion







